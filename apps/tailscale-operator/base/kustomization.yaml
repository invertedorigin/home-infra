apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
- external-secret.yaml
- namespace.yaml
- connector.yaml
- generic-device-plugin.yaml
- proxyclass.yaml

patches:
- target:
    group: apiextensions.k8s.io
    version: v1
    kind: CustomResourceDefinition
  patch: |-
    - op: add
      path: /metadata/annotations/argocd.argoproj.io~1sync-options
      value: ServerSideApply=true

helmCharts:
- name: tailscale-operator
  repo: https://pkgs.tailscale.com/helmcharts
  version: 1.94.2
  releaseName: tailscale-operator
  namespace: tailscale-operator
  includeCRDs: true
  valuesInline:
    apiServerProxyConfig:
      mode: "true"
