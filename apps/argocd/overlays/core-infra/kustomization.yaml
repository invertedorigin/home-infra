namespace: argocd

resources:
- github.com/argoproj/argo-cd//manifests/base?ref=v2.6.7
- infra-repo.yaml
- root-application.yaml
- ingress.yaml

components:
- ../../components/namespace
- ../../components/default-project-lockdown

patchesStrategicMerge:
- argocd-cm.yaml

patches:
- target:
    kind: "Service"
    name: "argocd-server"
  patch: |
    apiVersion: v1
    kind: Service
    metadata:
      name: argocd-server
      annotations:
        tailscale.com/expose: "true"
        tailscale.com/hostname: "argocd"
